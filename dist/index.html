<!DOCTYPE html>
<html style="height: 100%; margin: 0; position:relative">

<head>
  <meta charset="utf-8" />
  <title>CANVAS-UI test board</title>
  <style>
    .action {
      border: none;
      border-radius: 5px;
      padding: 6px;
      margin: 2px;
      font-weight: bold;
      font-size: 12px;
      font: sans-serif;
    }
  </style>
</head>

<body style="margin: 0; overflow: hidden; background-color: gray;position: absolute; top:0;left:0;right:0;bottom:0">
  <button class="action" onclick="newCanvas()">New</button>
  <button class="action" onclick="canvas.run()">Run</button>
  <button class="action" onclick="canvas.dump()">DUMP</button>
  <button class="action" onclick="exampleCanvas()">Example</button>
  <div id="cnodes"
    style="margin: 10px; border: 10px solid lightgray; background-color: white; position: absolute; top:20px; left:0; right:0; bottom:0">
  </div>

  <script src="main.js"></script>
  <script>

    let canvas = cnui.canvas('cnodes');

    function exampleCanvas() {
      // let prg = cnui.Env.import(JSON.parse(`{"id":"NID_384","version":1,"lastNodeIndex":347,"lastSocketIndex":1205,"enter":"NID_11","exit":"NID_12","nodes":[{"id":"NID_11","name":"Enter","functional":false,"meta":{"pos":{"x":-687.4407958984375,"y":-540.4018249511719}},"inputs":[{"id":"SID_39","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peer":null}],"outputs":[{"id":"SID_40","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peers":[]}],"prev":null,"nexts":[{"id":"SID_41","name":"Begin","node":null,"peer":null}]},{"id":"NID_12","name":"Exit","functional":false,"meta":{"pos":{"x":-9.83782958984375,"y":-541.5230407714844}},"inputs":[{"id":"SID_42","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peer":null}],"outputs":[{"id":"SID_43","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peers":[]}],"prev":{"id":"SID_44","name":"End","node":null,"peers":[]},"nexts":[]},{"id":"NID_13","name":"Setvar","functional":false,"meta":{"pos":{"x":367.56402587890625,"y":95.12271118164062}},"inputs":[{"id":"SID_45","name":"Name","node":null,"type":{},"value":"Fattoriale","peer":null},{"id":"SID_46","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1,"peer":null}],"outputs":[{"id":"SID_47","name":"Val","node":null,"type":{},"value":1,"peers":[]}],"prev":{"id":"SID_49","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_48","name":"Out","node":null,"peer":null}]},{"id":"NID_14","name":"FDiv","functional":true,"meta":{"pos":{"x":112.78068542480469,"y":307.5643310546875}},"inputs":[{"id":"SID_50","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null},{"id":"SID_51","name":"Val2","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null}],"outputs":[{"id":"SID_52","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_15","name":"For","functional":false,"meta":{"pos":{"x":685.4244384765625,"y":94.05479431152344}},"inputs":[{"id":"SID_53","name":"From","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null},{"id":"SID_54","name":"To","node":null,"type":{"type":"number","isArray":false},"value":10,"peer":null}],"outputs":[{"id":"SID_55","name":"Index","node":null,"type":{"type":"number","isArray":false},"value":9,"peers":[]}],"prev":{"id":"SID_58","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_56","name":"Out","node":null,"peer":null},{"id":"SID_57","name":"Do","node":null,"peer":null}]},{"id":"NID_17","name":"FGetvar","functional":true,"meta":{"pos":{"x":679.3650970458984,"y":378.5809326171875}},"inputs":[{"id":"SID_62","name":"Name","node":null,"type":{},"value":"Fattoriale","peer":null}],"outputs":[{"id":"SID_63","name":"Val","node":null,"type":{},"value":40320,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_18","name":"Setvar","functional":false,"meta":{"pos":{"x":1253.9583740234375,"y":122.64752197265625}},"inputs":[{"id":"SID_64","name":"Name","node":null,"type":{},"value":"Fattoriale","peer":null},{"id":"SID_65","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":362880,"peer":null}],"outputs":[{"id":"SID_66","name":"Val","node":null,"type":{},"value":362880,"peers":[]}],"prev":{"id":"SID_68","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_67","name":"Out","node":null,"peer":null}]},{"id":"NID_21","name":"FAdd","functional":true,"meta":{"pos":{"x":359.81756591796875,"y":-78.29185104370117}},"inputs":[{"id":"SID_74","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":9,"peer":null},{"id":"SID_75","name":"Val2","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null}],"outputs":[{"id":"SID_76","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":10,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_23","name":"FMul","functional":true,"meta":{"pos":{"x":981.8954772949219,"y":283.8112487792969}},"inputs":[{"id":"SID_80","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":9,"peer":null},{"id":"SID_81","name":"Val2","node":null,"type":{},"value":40320,"peer":null}],"outputs":[{"id":"SID_82","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":362880,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_65","name":"For","functional":false,"meta":{"pos":{"x":-82.6536865234375,"y":-314.65399169921875}},"inputs":[{"id":"SID_223","name":"From","node":null,"type":{"type":"number","isArray":0},"value":"0","peer":null},{"id":"SID_224","name":"To","node":null,"type":{"type":"number","isArray":0},"value":"10","peer":null}],"outputs":[{"id":"SID_225","name":"Index","node":null,"type":{"type":"number","isArray":false},"value":9,"peers":[]}],"prev":{"id":"SID_228","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_226","name":"Out","node":null,"peer":null},{"id":"SID_227","name":"Do","node":null,"peer":null}]},{"id":"NID_83","name":"FGetvar","functional":true,"meta":{"pos":{"x":682.1423950195312,"y":-126.18174743652344}},"inputs":[{"id":"SID_287","name":"Name","node":null,"type":{"type":"string","isArray":false},"value":"Fattoriale","peer":null}],"outputs":[{"id":"SID_288","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":362880,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_101","name":"Console","functional":false,"meta":{"pos":{"x":902.879638671875,"y":-318.0303955078125}},"inputs":[{"id":"SID_350","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":362880,"peer":null}],"outputs":[],"prev":{"id":"SID_352","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_351","name":"Out","node":null,"peer":null}]},{"id":"NID_120","name":"Console","functional":false,"meta":{"pos":{"x":1031.792724609375,"y":-16.893197059631348}},"inputs":[{"id":"SID_416","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":362880,"peer":null}],"outputs":[],"prev":{"id":"SID_418","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_417","name":"Out","node":null,"peer":null}]},{"id":"NID_312","name":"For","functional":false,"meta":{"pos":{"x":-357.94281005859375,"y":-541.6021118164062}},"inputs":[{"id":"SID_1081","name":"From","node":null,"type":{"type":"number","isArray":0},"value":"1","peer":null},{"id":"SID_1082","name":"To","node":null,"type":{"type":"number","isArray":0},"value":"10","peer":null}],"outputs":[{"id":"SID_1083","name":"Index","node":null,"type":{"type":"number","isArray":false},"value":9,"peers":[]}],"prev":{"id":"SID_1086","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_1084","name":"Out","node":null,"peer":null},{"id":"SID_1085","name":"Do","node":null,"peer":null}]}],"connections":[{"type":"pn","sourceNode":"NID_11","sourceSocket":"SID_41","targetNode":"NID_312","targetSocket":"SID_1086"},{"type":"pn","sourceNode":"NID_312","sourceSocket":"SID_1084","targetNode":"NID_12","targetSocket":"SID_44"},{"type":"pn","sourceNode":"NID_65","sourceSocket":"SID_227","targetNode":"NID_13","targetSocket":"SID_49"},{"type":"io","sourceNode":"NID_14","sourceSocket":"SID_52","targetNode":"NID_13","targetSocket":"SID_46"},{"type":"pn","sourceNode":"NID_13","sourceSocket":"SID_48","targetNode":"NID_15","targetSocket":"SID_58"},{"type":"io","sourceNode":"NID_21","sourceSocket":"SID_76","targetNode":"NID_15","targetSocket":"SID_54"},{"type":"io","sourceNode":"NID_15","sourceSocket":"SID_55","targetNode":"NID_23","targetSocket":"SID_80"},{"type":"pn","sourceNode":"NID_15","sourceSocket":"SID_56","targetNode":"NID_120","targetSocket":"SID_418"},{"type":"pn","sourceNode":"NID_15","sourceSocket":"SID_57","targetNode":"NID_18","targetSocket":"SID_68"},{"type":"io","sourceNode":"NID_17","sourceSocket":"SID_63","targetNode":"NID_23","targetSocket":"SID_81"},{"type":"io","sourceNode":"NID_23","sourceSocket":"SID_82","targetNode":"NID_18","targetSocket":"SID_65"},{"type":"io","sourceNode":"NID_65","sourceSocket":"SID_225","targetNode":"NID_21","targetSocket":"SID_74"},{"type":"pn","sourceNode":"NID_312","sourceSocket":"SID_1085","targetNode":"NID_65","targetSocket":"SID_228"},{"type":"pn","sourceNode":"NID_65","sourceSocket":"SID_226","targetNode":"NID_101","targetSocket":"SID_352"},{"type":"io","sourceNode":"NID_83","sourceSocket":"SID_288","targetNode":"NID_101","targetSocket":"SID_350"},{"type":"io","sourceNode":"NID_83","sourceSocket":"SID_288","targetNode":"NID_120","targetSocket":"SID_416"}]}`));
      let prg = cnui.Env.import(JSON.parse(`{"id":"NID_0","version":1,"lastNodeIndex":187,"lastSocketIndex":634,"enter":"NID_1","exit":"NID_2","nodes":[{"id":"NID_1","name":"Enter","functional":false,"meta":{"pos":{"x":100,"y":100}},"inputs":[{"id":"SID_4","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":"0","peer":null}],"outputs":[{"id":"SID_5","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peers":[]}],"prev":null,"nexts":[{"id":"SID_6","name":"Begin","node":null,"peer":null}]},{"id":"NID_2","name":"Exit","functional":false,"meta":{"pos":{"x":1113.48779296875,"y":151.54605102539062}},"inputs":[{"id":"SID_7","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":"0","peer":null}],"outputs":[{"id":"SID_8","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":"0","peers":[]}],"prev":{"id":"SID_9","name":"End","node":null,"peers":[]},"nexts":[]},{"id":"NID_3","name":"Program","functional":false,"meta":{"pos":{"x":454.2529296875,"y":139.80813598632812}},"program":{"id":"NID_3","version":1,"lastNodeIndex":187,"lastSocketIndex":634,"enter":"NID_4","exit":"NID_5","nodes":[{"id":"NID_4","name":"Enter","functional":false,"meta":{"pos":{"x":100,"y":100}},"inputs":[{"id":"SID_14","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"1.4142135623730951","peer":null}],"outputs":[{"id":"SID_15","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1.4142135623730951,"peers":[]}],"prev":null,"nexts":[{"id":"SID_16","name":"Begin","node":null,"peer":null}]},{"id":"NID_5","name":"Exit","functional":false,"meta":{"pos":{"x":839.0667114257812,"y":333.86407470703125}},"inputs":[{"id":"SID_17","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"1.4142135623730951","peer":null}],"outputs":[{"id":"SID_18","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1.4142135623730951,"peers":[]}],"prev":{"id":"SID_19","name":"End","node":null,"peers":[]},"nexts":[]},{"id":"NID_53","name":"Console","functional":false,"meta":{"pos":{"x":535.6111450195312,"y":69.15115356445312}},"inputs":[{"id":"SID_179","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"1.4142135623730951","peer":null}],"outputs":[],"prev":{"id":"SID_181","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_180","name":"Out","node":null,"peer":null}]}],"connections":[{"type":"io","sourceNode":"NID_4","sourceSocket":"SID_15","targetNode":"NID_53","targetSocket":"SID_179"},{"type":"io","sourceNode":"NID_4","sourceSocket":"SID_15","targetNode":"NID_5","targetSocket":"SID_17"},{"type":"pn","sourceNode":"NID_4","sourceSocket":"SID_16","targetNode":"NID_53","targetSocket":"SID_181"},{"type":"pn","sourceNode":"NID_53","sourceSocket":"SID_180","targetNode":"NID_5","targetSocket":"SID_19"}]},"inputs":[{"id":"SID_10","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"0","peer":null}],"outputs":[{"id":"SID_11","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1.4142135623730951,"peers":[]}],"prev":{"id":"SID_13","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_12","name":"Out","node":null,"peer":null}]},{"id":"NID_30","name":"Console","functional":false,"meta":{"pos":{"x":781.82861328125,"y":146.95428466796875}},"inputs":[{"id":"SID_101","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"0","peer":null}],"outputs":[],"prev":{"id":"SID_103","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_102","name":"Out","node":null,"peer":null}]},{"id":"NID_157","name":"FSqrt","functional":true,"meta":{"pos":{"x":218.82867431640625,"y":331.86773681640625}},"inputs":[{"id":"SID_536","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":"2","peer":null}],"outputs":[{"id":"SID_537","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1.4142135623730951,"peers":[]}],"prev":null,"nexts":[]}],"connections":[{"type":"pn","sourceNode":"NID_1","sourceSocket":"SID_6","targetNode":"NID_3","targetSocket":"SID_13"},{"type":"pn","sourceNode":"NID_30","sourceSocket":"SID_102","targetNode":"NID_2","targetSocket":"SID_9"},{"type":"io","sourceNode":"NID_157","sourceSocket":"SID_537","targetNode":"NID_3","targetSocket":"SID_10"},{"type":"io","sourceNode":"NID_3","sourceSocket":"SID_11","targetNode":"NID_30","targetSocket":"SID_101"},{"type":"pn","sourceNode":"NID_3","sourceSocket":"SID_12","targetNode":"NID_30","targetSocket":"SID_103"}]}`));
      canvas.program = prg;
    }

    function newCanvas() {
      canvas.program = new cnui.Program();
    }

    newCanvas();

  </script>
</body>

</html>
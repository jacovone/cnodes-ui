<!DOCTYPE html>
<html style="height: 100%; margin: 0; position:relative">

<head>
  <meta charset="utf-8" />
  <title>CANVAS-UI test board</title>
  <style>
    .action {
      border: none;
      border-radius: 5px;
      padding: 6px;
      margin: 2px;
      font-weight: bold;
      font-size: 12px;
      font: sans-serif;
    }
  </style>
</head>

<body style="margin: 0; overflow: hidden; background-color: gray;position: absolute; top:0;left:0;right:0;bottom:0">
  <button class="action" onclick="newCanvas()">New</button>
  <button class="action" onclick="canvas.run()">Run</button>
  <button class="action" onclick="canvas.dump()">DUMP</button>
  <button class="action" onclick="addNode('Setvar');">Setvar</button>
  <button class="action" onclick="addNode('Getvar');">Getvar</button>
  <button class="action" onclick="addNode('FGetvar');">FGetvar</button>
  <button class="action" onclick="addNode('Call');">Call</button>
  <button class="action" onclick="addNode('Console');">Console</button>
  <button class="action" onclick="addNode('If');">If</button>
  <button class="action" onclick="addNode('While');">While</button>
  <button class="action" onclick="addNode('For');">For</button>
  <button class="action" onclick="addNode('FDiv');">FDiv</button>
  <button class="action" onclick="addNode('FMul');">FMul</button>
  <button class="action" onclick="addNode('FAdd');">FAdd</button>
  <button class="action" onclick="addNode('FNotEqual');">FNotEqual</button>
  <button class="action" onclick="addNode('FLTE');">FLTE</button>
  <button class="action" onclick="addNode('FLT');">FLT</button>
  <button class="action" onclick="addNode('FGTE');">FGTE</button>
  <button class="action" onclick="addNode('FGT');">FGT</button>
  <button class="action" onclick="addNode('FEqual');">FEqual</button>
  <button class="action" onclick="exampleCanvas()">Example</button>
  <div id="cnodes"
    style="margin: 10px; border: 10px solid lightgray; background-color: white; position: absolute; top:20px; left:0; right:0; bottom:0">
  </div>

  <script src="main.js"></script>
  <script>

    let canvas = cnui.canvas('cnodes');

    function exampleCanvas() {
      let prg = cnui.Env.import(JSON.parse(`{"id":"NID_3","version":1,"lastNodeIndex":24,"lastSocketIndex":83,"enter":"NID_11","exit":"NID_12","nodes":[{"id":"NID_11","name":"Enter","functional":false,"meta":{"pos":{"x":54.644073486328125,"y":95.11929321289062}},"inputs":[{"id":"SID_39","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peer":null}],"outputs":[{"id":"SID_40","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peers":[]}],"prev":null,"nexts":[{"id":"SID_41","name":"Begin","node":null,"peer":null}]},{"id":"NID_12","name":"Exit","functional":false,"meta":{"pos":{"x":1332.643798828125,"y":-71.78141021728516}},"inputs":[{"id":"SID_42","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peer":null}],"outputs":[{"id":"SID_43","name":"Val","node":null,"type":{"type":"any","isArray":false},"value":0,"peers":[]}],"prev":{"id":"SID_44","name":"End","node":null,"peers":[]},"nexts":[]},{"id":"NID_13","name":"Setvar","functional":false,"meta":{"pos":{"x":367.56402587890625,"y":95.12271118164062}},"inputs":[{"id":"SID_45","name":"Name","node":null,"type":{},"value":"Contatore","peer":null},{"id":"SID_46","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1,"peer":null}],"outputs":[{"id":"SID_47","name":"Val","node":null,"type":{},"value":1,"peers":[]}],"prev":{"id":"SID_49","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_48","name":"Out","node":null,"peer":null}]},{"id":"NID_14","name":"FDiv","functional":true,"meta":{"pos":{"x":112.78068542480469,"y":307.5643310546875}},"inputs":[{"id":"SID_50","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null},{"id":"SID_51","name":"Val2","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null}],"outputs":[{"id":"SID_52","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":1,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_15","name":"For","functional":false,"meta":{"pos":{"x":685.4244384765625,"y":94.05479431152344}},"inputs":[{"id":"SID_53","name":"From","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null},{"id":"SID_54","name":"To","node":null,"type":{"type":"number","isArray":false},"value":17,"peer":null}],"outputs":[{"id":"SID_55","name":"Index","node":null,"type":{"type":"number","isArray":false},"value":16,"peers":[]}],"prev":{"id":"SID_58","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_56","name":"Out","node":null,"peer":null},{"id":"SID_57","name":"Do","node":null,"peer":null}]},{"id":"NID_16","name":"FAdd","functional":true,"meta":{"pos":{"x":998.93603515625,"y":633.6565246582031}},"inputs":[{"id":"SID_59","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":6,"peer":null},{"id":"SID_60","name":"Val2","node":null,"type":{},"value":0,"peer":null}],"outputs":[{"id":"SID_61","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":6,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_17","name":"FGetvar","functional":true,"meta":{"pos":{"x":679.3650970458984,"y":378.5809326171875}},"inputs":[{"id":"SID_62","name":"Name","node":null,"type":{},"value":"Contatore","peer":null}],"outputs":[{"id":"SID_63","name":"Val","node":null,"type":{},"value":1307674368000,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_18","name":"Setvar","functional":false,"meta":{"pos":{"x":1254.2227783203125,"y":122.64752197265625}},"inputs":[{"id":"SID_64","name":"Name","node":null,"type":{},"value":"Contatore","peer":null},{"id":"SID_65","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":20922789888000,"peer":null}],"outputs":[{"id":"SID_66","name":"Val","node":null,"type":{},"value":20922789888000,"peers":[]}],"prev":{"id":"SID_68","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_67","name":"Out","node":null,"peer":null}]},{"id":"NID_19","name":"Console","functional":false,"meta":{"pos":{"x":1013.1285400390625,"y":-74.39886856079102}},"inputs":[{"id":"SID_69","name":"Val","node":null,"type":{},"value":20922789888000,"peer":null}],"outputs":[],"prev":{"id":"SID_71","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_70","name":"Out","node":null,"peer":null}]},{"id":"NID_20","name":"FGetvar","functional":true,"meta":{"pos":{"x":667.0402069091797,"y":-101.62405395507812}},"inputs":[{"id":"SID_72","name":"Name","node":null,"type":{},"value":"Contatore","peer":null}],"outputs":[{"id":"SID_73","name":"Val","node":null,"type":{},"value":20922789888000,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_21","name":"FAdd","functional":true,"meta":{"pos":{"x":379.5592041015625,"y":352.2777099609375}},"inputs":[{"id":"SID_74","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":"16","peer":null},{"id":"SID_75","name":"Val2","node":null,"type":{"type":"number","isArray":false},"value":"1","peer":null}],"outputs":[{"id":"SID_76","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":17,"peers":[]}],"prev":null,"nexts":[]},{"id":"NID_22","name":"Console","functional":false,"meta":{"pos":{"x":658.6826171875,"y":648.6155395507812}},"inputs":[{"id":"SID_77","name":"Val","node":null,"type":{},"value":720,"peer":null}],"outputs":[],"prev":{"id":"SID_79","name":"In","node":null,"peers":[]},"nexts":[{"id":"SID_78","name":"Out","node":null,"peer":null}]},{"id":"NID_23","name":"FMul","functional":true,"meta":{"pos":{"x":981.8954772949219,"y":283.8112487792969}},"inputs":[{"id":"SID_80","name":"Val1","node":null,"type":{"type":"number","isArray":false},"value":16,"peer":null},{"id":"SID_81","name":"Val2","node":null,"type":{},"value":1307674368000,"peer":null}],"outputs":[{"id":"SID_82","name":"Val","node":null,"type":{"type":"number","isArray":false},"value":20922789888000,"peers":[]}],"prev":null,"nexts":[]}],"connections":[{"type":"pn","sourceNode":"NID_11","sourceSocket":"SID_41","targetNode":"NID_13","targetSocket":"SID_49"},{"type":"pn","sourceNode":"NID_19","sourceSocket":"SID_70","targetNode":"NID_12","targetSocket":"SID_44"},{"type":"io","sourceNode":"NID_14","sourceSocket":"SID_52","targetNode":"NID_13","targetSocket":"SID_46"},{"type":"pn","sourceNode":"NID_13","sourceSocket":"SID_48","targetNode":"NID_15","targetSocket":"SID_58"},{"type":"io","sourceNode":"NID_21","sourceSocket":"SID_76","targetNode":"NID_15","targetSocket":"SID_54"},{"type":"io","sourceNode":"NID_15","sourceSocket":"SID_55","targetNode":"NID_23","targetSocket":"SID_80"},{"type":"pn","sourceNode":"NID_15","sourceSocket":"SID_56","targetNode":"NID_19","targetSocket":"SID_71"},{"type":"pn","sourceNode":"NID_15","sourceSocket":"SID_57","targetNode":"NID_18","targetSocket":"SID_68"},{"type":"io","sourceNode":"NID_17","sourceSocket":"SID_63","targetNode":"NID_23","targetSocket":"SID_81"},{"type":"io","sourceNode":"NID_23","sourceSocket":"SID_82","targetNode":"NID_18","targetSocket":"SID_65"},{"type":"io","sourceNode":"NID_20","sourceSocket":"SID_73","targetNode":"NID_19","targetSocket":"SID_69"}]}`));
      canvas.program = prg;
    }

    function newCanvas() {
      canvas.program = new cnui.Program();
    }

    function addNode(name) {
      let node = cnui.Env.getInstance(name);
      let comp = new cnui.CnodeComponent(node, canvas);
      comp.pos = new cnui.Position(100, 100);
    }

    newCanvas();

  </script>
</body>

</html>